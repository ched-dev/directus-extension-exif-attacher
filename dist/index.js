"use strict";const e=[{prop:"dateTaken",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.CreateDate}},{prop:"cameraMake",getValue:e=>{var a;return null===(a=e.ifd0)||void 0===a?void 0:a.Make}},{prop:"cameraModel",getValue:e=>{var a;return null===(a=e.ifd0)||void 0===a?void 0:a.Model}},{prop:"iso",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.ISO}},{prop:"exposure",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.ExposureTime}},{prop:"aperture",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.FNumber}},{prop:"focalLength",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.FocalLength}},{prop:"focalLengthIn35mm",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.FocalLengthIn35mmFormat}},{prop:"lensMake",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.LensMake}},{prop:"lensModel",getValue:e=>{var a;return null===(a=e.exif)||void 0===a?void 0:a.LensModel}}],a=[{name:"media_library",imageFieldKey:"image",exifFields:e}];var t=({filter:t},{services:o})=>{a.map((a=>{const r=((a,t)=>async function(o,r,i){console.log(`${t.name} attachExifData start:`,{item:o,meta:r});const l=t.imageFieldKey||"image",n=o.hasOwnProperty(l)?o[l]:void 0;if(n){const r=t.exifFields||e;if(r.map((e=>o[e.prop]=null)),a&&a.ItemsService){const e=new a.ItemsService("directus_files",{schema:i.schema}),l=await e.readOne(n);console.log(`${t.name} attachExifData imageInfo:`,{imageInfo:l}),l&&l.metadata&&r.map((e=>{o[e.prop]=e.getValue(l.metadata)}))}console.log(`${t.name} attachExifData updated:`,{item:o})}else console.log(`${t.name} attachExifData noImage`);return o})(o,a);t(`${a.name}.items.create`,r),t(`${a.name}.items.update`,r)}))};module.exports=t;
